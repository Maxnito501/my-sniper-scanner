name: Run Sniper Bot

on:
  # ส่วนที่ 1: ตั้งเวลาออโต้ (10 โมง และ 5 โมงเย็น)
  schedule:
    - cron: '0 3 * * *'
    - cron: '0 10 * * *'
  
  # ส่วนที่ 2: คำสั่งสร้างปุ่มกด (สำคัญมาก! ต้องมีบรรทัดนี้ปุ่มถึงจะมา)
push:                   # <--- เพิ่มบรรทัดนี้ครับ! (พอกด Save บอทจะทำงานทันที)
  workflow_dispatch:      # <--- อันนี้คือปุ่มกด (เดี๋ยวจะมาหลังจากรันรอบแรกผ่าน)
  schedule:
    - cron: '0 3 * * *'
    - cron: '0 10 * * *'

jobs:
  run-sniper:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python 3.11
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install yfinance pandas requests

      - name: Run Auto Bot
        env:
          # ดึงกุญแจลับมาไขประตู
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          LINE_ACCESS_TOKEN: ${{ secrets.LINE_ACCESS_TOKEN }}
          LINE_USER_ID: ${{ secrets.LINE_USER_ID }}
        run: python auto_bot.py
