import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import numpy as np
import os

# --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ---
st.set_page_config(page_title="Titan Asset Manager V3.5", page_icon="üõ°Ô∏è", layout="wide")

st.title("üõ°Ô∏è Titan V3.5: Wealth & Pension Simulator")
st.markdown("**‡∏´‡πâ‡∏≠‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì (Financial & Pension Projection)**")

csv_file = 'assets.csv'

# --- 1. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Management) ---
if os.path.exists(csv_file):
    df = pd.read_csv(csv_file)
    
    # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå DCA
    if 'Monthly DCA (THB)' not in df.columns:
        df['Monthly DCA (THB)'] = 0
        df.to_csv(csv_file, index=False)

    # --- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Asset Editor) ---
    with st.expander("üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏° (‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î)", expanded=False):
        edited_df = st.data_editor(
            df,
            num_rows="dynamic",
            column_config={
                "Category": st.column_config.SelectboxColumn(
                    "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",
                    options=["High Yield (‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå)", "Investment (‡∏Å‡∏ö‡∏Ç.)", "Stocks (‡∏´‡∏∏‡πâ‡∏ô‡πÑ‡∏ó‡∏¢)", 
                             "Mutual Fund (RMF)", "Sniper (‡πÄ‡∏Å‡πá‡∏á‡∏Å‡∏≥‡πÑ‡∏£)", "Cash (‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á)", "Gold (‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥)"],
                    required=True
                ),
                "Value (THB)": st.column_config.NumberColumn("‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", format="%d ‡∏ø"),
                "Monthly DCA (THB)": st.column_config.NumberColumn("‡∏≠‡∏≠‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", format="%d ‡∏ø", help="‡πÉ‡∏™‡πà 0 ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô"),
                "Expected Return (%)": st.column_config.NumberColumn("‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á/‡∏õ‡∏µ", format="%.1f%%"),
            },
            use_container_width=True
        )

        if st.button("üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Save)"):
            edited_df.to_csv(csv_file, index=False)
            st.success("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!")
            st.rerun()

    # --- 2. ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï (Simulation Engine) ---
    st.write("---")
    st.subheader("üöÄ ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì (‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç + ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô)")

    # Input ‡∏´‡∏•‡∏±‡∏Å
    col1, col2, col3 = st.columns(3)
    
    with col1:
        st.markdown("##### ‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤ & ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢")
        years_to_sim = st.number_input("‡∏≠‡∏µ‡∏Å‡∏Å‡∏µ‡πà‡∏õ‡∏µ‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì (‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°‡πÑ‡∏î‡πâ)", min_value=0.1, max_value=40.0, value=9.75, step=0.25)
        target_wealth = st.number_input("‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó)", min_value=1000000, value=5000000, step=500000)
    
    with col2:
        st.markdown("##### üëÆ‚Äç‚ôÇÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£")
        pension_mode = st.radio("‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç:", ["‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£)", "‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á (Manual)"])
        
        if pension_mode == "‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á (Manual)":
            final_pension = st.number_input("‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏≠‡∏î‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ (‡∏ö‡∏≤‡∏ó)", value=49000)
            avg_last_60_salary = 0 
        else:
            current_salary = st.number_input("‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", value=48780)
            salary_cap = st.number_input("‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ï‡∏±‡∏ô‡∏ó‡∏µ‡πà", value=73000)
            total_gov_years_at_retire = st.number_input("‡∏≠‡∏≤‡∏¢‡∏∏‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏ï‡∏≠‡∏ô‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì (‡∏õ‡∏µ)", value=35.10, step=0.1, format="%.2f")

    with col3:
        st.markdown("##### üìà ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ê‡∏≤‡∏ô")
        if pension_mode != "‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á (Manual)":
            salary_growth = st.slider("‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (%/‡∏õ‡∏µ)", 0.0, 10.0, 3.0, 0.1)
        safe_withdraw_rate = st.slider("‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô(‡∏≠‡∏∑‡πà‡∏ô)‡∏°‡∏≤‡πÉ‡∏ä‡πâ (%/‡∏õ‡∏µ)", 1.0, 6.0, 4.0, 0.5)
        st.caption("*‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å")

    # --- Logic ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ---
    if not edited_df.empty:
        
        # [A] ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç
        if pension_mode == "‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£)":
            sim_salary = current_salary
            salary_history = []
            sim_years = int(years_to_sim) + 1 
            for y in range(1, sim_years + 1):
                sim_salary = sim_salary * (1 + salary_growth / 100)
                if sim_salary > salary_cap: sim_salary = salary_cap
                if y > (sim_years - 5):
                    salary_history.extend([sim_salary] * 12)

            while len(salary_history) < 60:
                salary_history.insert(0, current_salary)
                
            last_60_months = salary_history[-60:]
            avg_last_60_salary = sum(last_60_months) / 60
            
            raw_pension = (avg_last_60_salary * total_gov_years_at_retire) / 50
            max_pension = avg_last_60_salary * 0.70
            final_pension = min(raw_pension, max_pension)

        # [B] ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô (Wealth Simulation)
        current_assets_val = edited_df['Value (THB)'].sum()
        wealth_over_time = {0: current_assets_val}
        
        sim_df = edited_df.copy()
        sim_df['Monthly Rate'] = sim_df['Expected Return (%)'] / 100 / 12
        
        months_total = int(years_to_sim * 12)
        months = np.arange(1, months_total + 1)
        
        asset_growth_history = []
        is_coop = sim_df['Category'] == "High Yield (‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå)"

        for m in months:
            # 1. ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏ó‡∏ö‡∏ï‡πâ‡∏ô)
            sim_df.loc[~is_coop, 'Value (THB)'] = (sim_df.loc[~is_coop, 'Value (THB)'] * (1 + sim_df.loc[~is_coop, 'Monthly Rate'])) + sim_df.loc[~is_coop, 'Monthly DCA (THB)']
            # 2. ‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå (‡πÑ‡∏°‡πà‡∏ó‡∏ö‡∏ï‡πâ‡∏ô)
            sim_df.loc[is_coop, 'Value (THB)'] = sim_df.loc[is_coop, 'Value (THB)'] + sim_df.loc[is_coop, 'Monthly DCA (THB)']

            wealth_over_time[m] = sim_df['Value (THB)'].sum()
            
            # ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≥‡∏Å‡∏£‡∏≤‡∏ü Area
            if m % 12 == 0 or m == months_total:
                 for index, row in sim_df.iterrows():
                    asset_growth_history.append({
                        "Month": m,
                        "Year": m / 12,
                        "Category": row['Category'],
                        "Asset Name": row['Asset Name'],
                        "Value": row['Value (THB)']
                    })

        final_wealth = wealth_over_time[months_total] if months_total > 0 else current_assets_val
        
        # [C] ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì (Income Breakdown)
        # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå (‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢)
        final_coop_df = sim_df[is_coop]
        coop_income_monthly = (final_coop_df['Value (THB)'] * (final_coop_df['Expected Return (%)'] / 100)).sum() / 12
        
        # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏ñ‡∏≠‡∏ô 4%)
        final_other_df = sim_df[~is_coop]
        other_income_monthly = (final_other_df['Value (THB)'].sum() * (safe_withdraw_rate/100)) / 12
        
        total_monthly_income = final_pension + coop_income_monthly + other_income_monthly

        # --- D. ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (Dashboard) ---
        st.info(f"üìä **‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏ì ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì (‡∏≠‡∏µ‡∏Å {years_to_sim} ‡∏õ‡∏µ)**")
        
        k1, k2, k3, k4 = st.columns(4)
        k1.metric("üí∞ ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏™‡∏∞‡∏™‡∏° (Wealth)", f"{final_wealth/1000000:,.2f} ‡∏•‡πâ‡∏≤‡∏ô‡∏ø", 
                  f"‡∏Å‡∏≥‡πÑ‡∏£: {(final_wealth - current_assets_val)/1000:,.0f}k")
        
        k2.metric("üèõÔ∏è ‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£", f"{final_pension:,.0f} ‡∏ø", "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏Å")
        
        k3.metric("üí∏ ‡∏î‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏á‡∏ó‡∏∏‡∏ô (‡∏£‡∏ß‡∏°)", f"{(coop_income_monthly + other_income_monthly):,.0f} ‡∏ø", 
                  f"‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå+‡∏ñ‡∏≠‡∏ô‡πÉ‡∏ä‡πâ")
        
        k4.metric("‚úÖ ‡∏£‡∏ß‡∏°‡∏°‡∏µ‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", f"{total_monthly_income:,.0f} ‡∏ø", "‡∏™‡∏ö‡∏≤‡∏¢‡∏°‡∏≤‡∏Å!")

        # --- E. ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏£‡∏≤‡∏ü (‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î) ---
        st.write("---")
        
        col_pie, col_bar = st.columns(2)
        
        # 1. Pie Chart (‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô)
        with col_pie:
            st.subheader("ü•ß ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô (‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì)")
            fig_pie = px.pie(sim_df, values='Value (THB)', names='Category', 
                             title=f'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á‡∏£‡∏ß‡∏° {final_wealth/1000000:,.2f} ‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó', hole=0.4)
            fig_pie.update_traces(textposition='inside', textinfo='percent+label')
            st.plotly_chart(fig_pie, use_container_width=True)
            
        # 2. Bar Chart (‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ)
        with col_bar:
            st.subheader("üíµ ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô")
            income_data = [
                {"Source": "‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç", "Amount": final_pension, "Color": "#3b82f6"},
                {"Source": "‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå", "Amount": coop_income_monthly, "Color": "#22c55e"},
                {"Source": "‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô", "Amount": other_income_monthly, "Color": "#f59e0b"}
            ]
            income_df = pd.DataFrame(income_data)
            fig_bar = px.bar(income_df, x="Source", y="Amount", color="Source", 
                             text_auto=',.0f', title=f"‡∏£‡∏ß‡∏° {total_monthly_income:,.0f} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                             color_discrete_map={"‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç":"#3b82f6", "‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå":"#22c55e", "‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô":"#f59e0b"})
            fig_bar.update_layout(showlegend=False)
            st.plotly_chart(fig_bar, use_container_width=True)

        # 3. Line Chart (‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á)
        st.subheader("üìà ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏π‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á (Wealth Projection)")
        chart_data = pd.DataFrame({
            "Month": list(wealth_over_time.keys()),
            "Portfolio Value": list(wealth_over_time.values())
        })
        chart_data['Target'] = target_wealth
        
        fig = go.Figure()
        fig.add_trace(go.Scatter(x=chart_data['Month'], y=chart_data['Portfolio Value'], 
                                 mode='lines', name='‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏™‡∏∞‡∏™‡∏°', line=dict(color='#00CC96', width=3)))
        fig.add_trace(go.Scatter(x=chart_data['Month'], y=chart_data['Target'], 
                                 mode='lines', name='‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô', line=dict(color='red', dash='dot')))
        fig.update_layout(height=400, xaxis_title="‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", yaxis_title="‡∏ö‡∏≤‡∏ó")
        st.plotly_chart(fig, use_container_width=True)
        
        # 4. Area Chart (‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÅ‡∏¢‡∏Å‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå)
        if asset_growth_history:
            st.subheader("üß© ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå")
            area_df = pd.DataFrame(asset_growth_history)
            fig_area = px.area(area_df, x="Year", y="Value", color="Category", 
                               groupnorm=None)
            st.plotly_chart(fig_area, use_container_width=True)

    else:
        st.warning("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö")

else:
    st.error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• assets.csv")
